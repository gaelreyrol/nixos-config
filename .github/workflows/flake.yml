on: [pull_request, push]
jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: |
          eval `ssh-agent -s`
          ssh-add - <<< '${{ secrets.RECISIO_SSH_KEY }}'
          curl -L https://nixos.org/nix/install | sh
          . ~/.nix-profile/etc/profile.d/nix.sh
          nix-env -iA nixpkgs.nixUnstable
          mkdir -p ~/.config/nix/
          echo "experimental-features = nix-command flakes" >> ~/.config/nix/nix.conf
          nix flake check